2024-05-14 20:42:06,835 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-05-14 20:42:06,835 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Configure stats pid to 50948
2024-05-14 20:42:06,835 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Loading settings from /Users/ishi/.config/wandb/settings
2024-05-14 20:42:06,835 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Loading settings from /Users/ishi/opencatalystproject/wandb/settings
2024-05-14 20:42:06,835 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'main.py', 'program_abspath': '/Users/ishi/opencatalystproject/main.py', 'program': '/Users/ishi/opencatalystproject/main.py'}
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_init.py:_log_setup():521] Logging user logs to ./logs/wandb/2024-05-14-20-41-52/wandb/run-20240514_204206-2024-05-14-20-41-52/logs/debug.log
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_init.py:_log_setup():522] Logging internal logs to ./logs/wandb/2024-05-14-20-41-52/wandb/run-20240514_204206-2024-05-14-20-41-52/logs/debug-internal.log
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_init.py:init():561] calling init triggers
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'task': {'dataset': 'trajectory_lmdb', 'description': 'Regressing to energies and forces for DFT trajectories from OCP', 'type': 'regression', 'metric': 'mae', 'labels': ['potential energy'], 'grad_input': 'atomic forces', 'train_on_free_atoms': True, 'eval_on_free_atoms': True}, 'trainer': 's2ef', 'model': 'schnet', 'model_attributes': {'hidden_channels': 1024, 'num_filters': 256, 'num_interactions': 5, 'num_gaussians': 200, 'cutoff': 6.0, 'use_pbc': True}, 'outputs': {'energy': {'level': 'system'}, 'forces': {'level': 'atom', 'train_on_free_atoms': True, 'eval_on_free_atoms': True}}, 'optim': {'batch_size': 20, 'eval_batch_size': 20, 'eval_every': 10000, 'num_workers': 0, 'lr_initial': 0.0001, 'lr_gamma': 0.1, 'lr_milestones': [313907, 523179, 732451], 'warmup_steps': 209271, 'warmup_factor': 0.2, 'max_epochs': 15, 'force_coefficient': 30}, 'loss_fns': [{'energy': {'fn': 'mae', 'coefficient': 1}}, {'forces': {'fn': 'l2mae', 'coefficient': 30}}], 'eval_metrics': {'metrics': {'misc': ['energy_forces_within_threshold'], 'energy': ['mae'], 'forces': ['forcesx_mae', 'forcesy_mae', 'forcesz_mae', 'mae', 'cosine_similarity', 'magnitude_error']}}, 'logger': 'wandb', 'amp': False, 'gpus': 0, 'cmd': {'identifier': '', 'print_every': 10, 'seed': 0, 'timestamp_id': '2024-05-14-20-41-52', 'commit': None, 'checkpoint_dir': './checkpoints/2024-05-14-20-41-52', 'results_dir': './results/2024-05-14-20-41-52', 'logs_dir': './logs/wandb/2024-05-14-20-41-52'}, 'slurm': {}, 'noddp': False, 'dataset': {'src': 'data/s2ef/mytrain/', 'normalize_labels': True, 'target_mean': -0.7554450631141663, 'target_std': 2.887317180633545, 'grad_target_mean': 0.0, 'grad_target_std': 2.887317180633545, 'format': 'trajectory_lmdb', 'key_mapping': {'y': 'energy', 'force': 'forces'}, 'transforms': {'normalizer': {'energy': {'mean': -0.7554450631141663, 'stdev': 2.887317180633545}, 'forces': {'mean': 0.0, 'stdev': 2.887317180633545}}}}, 'val_dataset': {'src': 'data/s2ef/myval/'}}
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_init.py:init():611] starting backend
2024-05-14 20:42:06,836 INFO    MainThread:50948 [wandb_init.py:init():615] setting up manager
2024-05-14 20:42:06,838 INFO    MainThread:50948 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2024-05-14 20:42:06,841 INFO    MainThread:50948 [wandb_init.py:init():623] backend started and connected
2024-05-14 20:42:06,847 INFO    MainThread:50948 [wandb_init.py:init():715] updated telemetry
2024-05-14 20:42:06,879 INFO    MainThread:50948 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-05-14 20:42:07,591 INFO    MainThread:50948 [wandb_run.py:_on_init():2357] communicating current version
2024-05-14 20:42:07,718 INFO    MainThread:50948 [wandb_run.py:_on_init():2366] got version response upgrade_message: "wandb version 0.17.0 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-05-14 20:42:07,719 INFO    MainThread:50948 [wandb_init.py:init():799] starting run threads in backend
2024-05-14 20:42:07,858 INFO    MainThread:50948 [wandb_run.py:_console_start():2335] atexit reg
2024-05-14 20:42:07,858 INFO    MainThread:50948 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-05-14 20:42:07,858 INFO    MainThread:50948 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-05-14 20:42:07,858 INFO    MainThread:50948 [wandb_run.py:_redirect():2280] Redirects installed.
2024-05-14 20:42:07,858 INFO    MainThread:50948 [wandb_init.py:init():842] run started, returning control to user process
2024-05-14 20:42:07,986 INFO    MainThread:50948 [wandb_watch.py:watch():51] Watching
2024-05-14 20:46:44,168 WARNING MsgRouterThr:50948 [router.py:message_loop():77] message_loop has been closed
